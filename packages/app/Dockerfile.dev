# Development Dockerfile
FROM oven/bun:1
WORKDIR /app

# Copy root package files for workspace support
COPY package.json bun.lock* ./

# Copy app package files
COPY packages/app/package.json ./packages/app/
COPY packages/app/tsconfig.json ./packages/app/
COPY packages/app/bunfig.toml ./packages/app/

# Install all dependencies (including devDependencies for TypeScript, etc.)
RUN bun install

# Copy app source code (will be overridden by volume mount in dev)
# Only copy specific files/directories to avoid overwriting node_modules
COPY packages/app/src ./packages/app/src
COPY packages/app/build.ts ./packages/app/build.ts
COPY packages/app/components.json ./packages/app/components.json
COPY packages/app/bun-env.d.ts ./packages/app/bun-env.d.ts
COPY packages/app/styles ./packages/app/styles

# Set working directory to app
WORKDIR /app/packages/app

# Expose server port
EXPOSE 8080

# Run dev server with hot reload
CMD ["bun", "--hot", "src/index.ts"]

